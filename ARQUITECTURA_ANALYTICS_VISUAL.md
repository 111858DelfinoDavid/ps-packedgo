# ğŸ—ï¸ ARQUITECTURA DEL ANALYTICS SERVICE

## ğŸ“ DIAGRAMA DE ARQUITECTURA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PACKEDGO PLATFORM                                   â”‚
â”‚                        Multi-Tenant SaaS System                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            FRONTEND LAYER                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    Angular 19 Application                           â”‚    â”‚
â”‚  â”‚                     (http://localhost:4200)                         â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  Login/Register â”‚  â”‚  Admin Dashboard â”‚  â”‚  Analytics Dashboardâ”‚    â”‚
â”‚  â”‚  â”‚   Components    â”‚  â”‚   Components     â”‚  â”‚    Component       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚           â”‚                     â”‚                       â”‚             â”‚    â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚                                 â”‚                                     â”‚    â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
â”‚  â”‚                    â”‚   AnalyticsService.ts     â”‚                     â”‚    â”‚
â”‚  â”‚                    â”‚  (HTTP Client - Charts)   â”‚                     â”‚    â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
â”‚  â”‚                                 â”‚                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                          â”‚
â”‚                          HTTP/JSON â”‚ (Authorization: Bearer JWT)              â”‚
â”‚                                    â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            BACKEND LAYER                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    ANALYTICS SERVICE (Port 8087)                         â”‚ â”‚
â”‚  â”‚                    analytics-service-0.0.1-SNAPSHOT.jar                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                    DashboardController.java                       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  GET /api/dashboard                 â† Authenticated User         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  GET /api/dashboard/{organizerId}   â† SUPER_ADMIN Only           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  GET /api/dashboard/health          â† Public                     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                         â”‚                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                   JwtTokenValidator.java                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - Extract userId from token                                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - Validate JWT signature                                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - Verify role (ADMIN/SUPER_ADMIN)                                â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                         â”‚                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                    AnalyticsService.java                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Main Methods:                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - getDashboardForUser(userId)                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - getDashboardForOrganizer(organizerId)                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Calculation Methods:                                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - calculateSalesMetrics(orders)                                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - calculateEventMetrics(events)                                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - calculateConsumptionMetrics(consumptions, orders)              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - calculateRevenueMetrics(orders)                                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - calculateTopPerformers(events, consumptions, orders)           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - calculateTrends(orders)                                        â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                         â”‚                                               â”‚ â”‚
â”‚  â”‚                         â”‚ RestTemplate HTTP Calls                       â”‚ â”‚
â”‚  â”‚                         â”‚                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚              External Service Clients                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Event Service:   http://localhost:8086                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    - GET /api/events/my-events                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    - GET /api/consumptions/my-consumptions                        â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Order Service:   http://localhost:8084                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    - GET /api/orders/organizer/{organizerId}                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Payment Service: http://localhost:8085                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    - GET /api/payments/organizer/{organizerId}                    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Auth Service â”‚  â”‚ Event Serviceâ”‚  â”‚ Order Serviceâ”‚  â”‚Payment Serviceâ”‚   â”‚
â”‚  â”‚ Port 8081    â”‚  â”‚ Port 8086    â”‚  â”‚ Port 8084    â”‚  â”‚ Port 8085    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                 â”‚                  â”‚                  â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                  â”‚                  â”‚
          â”‚                 â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATABASE LAYER                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   auth_db    â”‚  â”‚  events_db   â”‚  â”‚  orders_db   â”‚  â”‚ payments_db  â”‚    â”‚
â”‚  â”‚  Port 5433   â”‚  â”‚  Port 5436   â”‚  â”‚  Port 5434   â”‚  â”‚  Port 5435   â”‚    â”‚
â”‚  â”‚ PostgreSQL15 â”‚  â”‚ PostgreSQL15 â”‚  â”‚ PostgreSQL15 â”‚  â”‚ PostgreSQL15 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                             â”‚
â”‚  â”‚ analytics_db â”‚  â† NO TABLES (reads from services via HTTP)                â”‚
â”‚  â”‚  Port 5439   â”‚                                                             â”‚
â”‚  â”‚ PostgreSQL15 â”‚                                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š FLUJO DE DATOS

### **Flujo 1: Usuario accede al Dashboard**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Usuario    â”‚
â”‚   (Admin)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. Ingresa credenciales
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Login Component               â”‚
â”‚  (Angular Frontend)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. POST /api/auth/login
       â”‚    { email, password }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Auth Service (8081)           â”‚
â”‚  - Valida credenciales              â”‚
â”‚  - Genera JWT con userId, role      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. Retorna JWT Token
       â”‚    { access_token, user_id, role }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Angular guarda token en          â”‚
â”‚    localStorage o sessionStorage    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 4. Usuario navega a /admin/analytics
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DashboardAnalyticsComponent       â”‚
â”‚  - ngOnInit() llama a service       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 5. GET /api/dashboard
       â”‚    Authorization: Bearer {JWT}
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Analytics Service (8087)           â”‚
â”‚  DashboardController                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 6. Valida JWT
       â”‚    JwtTokenValidator.extractUserId()
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     AnalyticsService                â”‚
â”‚  - Obtiene eventos                  â”‚
â”‚  - Obtiene Ã³rdenes                  â”‚
â”‚  - Obtiene pagos                    â”‚
â”‚  - Calcula mÃ©tricas                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 7. Retorna DashboardDTO
       â”‚    { salesMetrics, eventMetrics, ... }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Angular Component                 â”‚
â”‚  - Renderiza KPIs                   â”‚
â”‚  - Dibuja grÃ¡ficos con Chart.js     â”‚
â”‚  - Muestra tablas                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 8. Usuario ve dashboard
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Usuario    â”‚
â”‚ Ve mÃ©tricas  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUJO DE AGREGACIÃ“N DE MÃ‰TRICAS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AnalyticsService.java                                   â”‚
â”‚                                                                              â”‚
â”‚  getDashboardForUser(userId)                                                â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 1. Fetch Events                                                 â”‚
â”‚         â”‚      RestTemplate.exchange(                                       â”‚
â”‚         â”‚         "http://localhost:8086/api/events/my-events",             â”‚
â”‚         â”‚         headers = { Authorization: Bearer {JWT} }                 â”‚
â”‚         â”‚      )                                                             â”‚
â”‚         â”‚      â–¼                                                             â”‚
â”‚         â”‚   List<Event> events = [Event1, Event2, Event3...]               â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 2. Fetch Consumptions                                           â”‚
â”‚         â”‚      RestTemplate.exchange(                                       â”‚
â”‚         â”‚         "http://localhost:8086/api/consumptions/my-consumptions", â”‚
â”‚         â”‚         headers = { Authorization: Bearer {JWT} }                 â”‚
â”‚         â”‚      )                                                             â”‚
â”‚         â”‚      â–¼                                                             â”‚
â”‚         â”‚   List<Consumption> consumptions = [C1, C2, C3...]               â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 3. Fetch Orders                                                 â”‚
â”‚         â”‚      RestTemplate.exchange(                                       â”‚
â”‚         â”‚         "http://localhost:8084/api/orders/organizer/{userId}",    â”‚
â”‚         â”‚         headers = { Authorization: Bearer {JWT} }                 â”‚
â”‚         â”‚      )                                                             â”‚
â”‚         â”‚      â–¼                                                             â”‚
â”‚         â”‚   List<Order> orders = [Order1, Order2, Order3...]               â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 4. Fetch Payments                                               â”‚
â”‚         â”‚      RestTemplate.exchange(                                       â”‚
â”‚         â”‚         "http://localhost:8085/api/payments/organizer/{userId}",  â”‚
â”‚         â”‚         headers = { Authorization: Bearer {JWT} }                 â”‚
â”‚         â”‚      )                                                             â”‚
â”‚         â”‚      â–¼                                                             â”‚
â”‚         â”‚   List<Payment> payments = [Payment1, Payment2, Payment3...]     â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 5. Calculate Sales Metrics                                      â”‚
â”‚         â”‚      SalesMetricsDTO = calculateSalesMetrics(orders)              â”‚
â”‚         â”‚        - totalTicketsSold = SUM(order.tickets.size())            â”‚
â”‚         â”‚        - totalOrders = orders.size()                              â”‚
â”‚         â”‚        - averageTicketsPerOrder = totalTickets / totalOrders      â”‚
â”‚         â”‚        - conversionRate = (paidOrders / totalOrders) * 100        â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 6. Calculate Event Metrics                                      â”‚
â”‚         â”‚      EventMetricsDTO = calculateEventMetrics(events)              â”‚
â”‚         â”‚        - totalEvents = events.size()                              â”‚
â”‚         â”‚        - activeEvents = events.filter(e => e.status == ACTIVE)    â”‚
â”‚         â”‚        - totalCapacity = SUM(event.capacity)                      â”‚
â”‚         â”‚        - averageOccupancy = (tickets / capacity) * 100            â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 7. Calculate Consumption Metrics                                â”‚
â”‚         â”‚      ConsumptionMetricsDTO = calculateConsumptionMetrics(...)     â”‚
â”‚         â”‚        - totalConsumptions = consumptions.size()                  â”‚
â”‚         â”‚        - totalSold = SUM(consumption.quantitySold)                â”‚
â”‚         â”‚        - redemptionRate = (redeemed / sold) * 100                 â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 8. Calculate Revenue Metrics                                    â”‚
â”‚         â”‚      RevenueMetricsDTO = calculateRevenueMetrics(orders)          â”‚
â”‚         â”‚        - totalRevenue = SUM(order.totalAmount)                    â”‚
â”‚         â”‚        - ticketsRevenue = SUM(order.tickets.price)                â”‚
â”‚         â”‚        - consumptionsRevenue = SUM(order.consumptions.price)      â”‚
â”‚         â”‚        - growthRate = ((thisMonth - lastMonth) / lastMonth) * 100 â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 9. Calculate Top Performers                                     â”‚
â”‚         â”‚      TopPerformersDTO = calculateTopPerformers(...)               â”‚
â”‚         â”‚        - topEvents = events.sortBy(ticketsSold).take(5)           â”‚
â”‚         â”‚        - topConsumptions = consumptions.sortBy(sold).take(5)      â”‚
â”‚         â”‚        - topCategories = groupBy(category).sortBy(revenue)        â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â”œâ”€â–º 10. Calculate Trends                                            â”‚
â”‚         â”‚      TrendsDTO = calculateTrends(orders)                          â”‚
â”‚         â”‚        - dailyTrends = orders.groupBy(date).last30Days()          â”‚
â”‚         â”‚        - monthlyTrends = orders.groupBy(yearMonth).last12Months() â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â””â”€â–º 11. Build DashboardDTO                                          â”‚
â”‚                DashboardDTO dashboard = DashboardDTO.builder()              â”‚
â”‚                   .organizerId(userId)                                      â”‚
â”‚                   .salesMetrics(salesMetrics)                               â”‚
â”‚                   .eventMetrics(eventMetrics)                               â”‚
â”‚                   .consumptionMetrics(consumptionMetrics)                   â”‚
â”‚                   .revenueMetrics(revenueMetrics)                           â”‚
â”‚                   .topPerformers(topPerformers)                             â”‚
â”‚                   .trends(trends)                                           â”‚
â”‚                   .lastUpdated(LocalDateTime.now())                         â”‚
â”‚                   .build();                                                 â”‚
â”‚                                                                              â”‚
â”‚                return dashboard;                                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” FLUJO DE SEGURIDAD

### **JWT Validation Flow**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HTTP Request                      â”‚
â”‚   GET /api/dashboard                â”‚
â”‚   Authorization: Bearer {JWT}       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DashboardController               â”‚
â”‚   @GetMapping("/api/dashboard")     â”‚
â”‚   getDashboard(@RequestHeader       â”‚
â”‚                 Authorization)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. Extract "Bearer {token}"
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   JwtTokenValidator                 â”‚
â”‚   extractUserId(token)              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. Parse JWT
       â”‚
       â”œâ”€â–º Verificar firma HMAC SHA-256
       â”‚   con JWT_SECRET
       â”‚
       â”œâ”€â–º Verificar expiraciÃ³n
       â”‚   exp > now()
       â”‚
       â”œâ”€â–º Extraer Claims
       â”‚   - sub (userId)
       â”‚   - role
       â”‚   - iat, exp
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ValidaciÃ³n de Rol                 â”‚
â”‚   verifyRole(userId)                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–º Â¿Role == ADMIN?      âœ“ PERMITIR
       â”‚
       â”œâ”€â–º Â¿Role == SUPER_ADMIN? âœ“ PERMITIR
       â”‚
       â”œâ”€â–º Â¿Role == CONSUMER?    âœ— 403 FORBIDDEN
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Multi-Tenant Validation           â”‚
â”‚   (Solo organizador ve sus datos)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Â¿Endpoint == /api/dashboard?
       â”‚ â†’ Retornar datos del userId del token
       â”‚
       â”‚ Â¿Endpoint == /api/dashboard/{id}?
       â”‚ â†’ Verificar SUPER_ADMIN
       â”‚ â†’ Retornar datos del {id} especificado
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AnalyticsService                  â”‚
â”‚   getDashboardForUser(userId)       â”‚
â”‚   (Todos los datos filtrados        â”‚
â”‚    por createdBy = userId)          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Retornar DashboardDTO             â”‚
â”‚   200 OK                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—‚ï¸ ESTRUCTURA DE DTOs

```
DashboardDTO
â”œâ”€â”€ organizerId: Long
â”œâ”€â”€ organizerName: String
â”œâ”€â”€ lastUpdated: LocalDateTime
â”‚
â”œâ”€â”€ salesMetrics: SalesMetricsDTO
â”‚   â”œâ”€â”€ totalTicketsSold: Integer
â”‚   â”œâ”€â”€ totalOrders: Integer
â”‚   â”œâ”€â”€ averageTicketsPerOrder: Double
â”‚   â””â”€â”€ conversionRate: Double
â”‚
â”œâ”€â”€ eventMetrics: EventMetricsDTO
â”‚   â”œâ”€â”€ totalEvents: Integer
â”‚   â”œâ”€â”€ activeEvents: Integer
â”‚   â”œâ”€â”€ pastEvents: Integer
â”‚   â”œâ”€â”€ totalCapacity: Integer
â”‚   â””â”€â”€ averageOccupancyRate: Double
â”‚
â”œâ”€â”€ consumptionMetrics: ConsumptionMetricsDTO
â”‚   â”œâ”€â”€ totalConsumptions: Integer
â”‚   â”œâ”€â”€ totalSold: Integer
â”‚   â””â”€â”€ redemptionRate: Double
â”‚
â”œâ”€â”€ revenueMetrics: RevenueMetricsDTO
â”‚   â”œâ”€â”€ totalRevenue: BigDecimal
â”‚   â”œâ”€â”€ ticketsRevenue: BigDecimal
â”‚   â”œâ”€â”€ consumptionsRevenue: BigDecimal
â”‚   â”œâ”€â”€ thisMonthRevenue: BigDecimal
â”‚   â”œâ”€â”€ lastMonthRevenue: BigDecimal
â”‚   â””â”€â”€ growthRate: Double
â”‚
â”œâ”€â”€ topPerformers: TopPerformersDTO
â”‚   â”œâ”€â”€ topEvents: List<EventPerformanceDTO>
â”‚   â”‚   â”œâ”€â”€ eventId: Long
â”‚   â”‚   â”œâ”€â”€ eventName: String
â”‚   â”‚   â”œâ”€â”€ ticketsSold: Integer
â”‚   â”‚   â”œâ”€â”€ revenue: BigDecimal
â”‚   â”‚   â””â”€â”€ occupancyRate: Double
â”‚   â”‚
â”‚   â”œâ”€â”€ topConsumptions: List<ConsumptionPerformanceDTO>
â”‚   â”‚   â”œâ”€â”€ consumptionId: Long
â”‚   â”‚   â”œâ”€â”€ consumptionName: String
â”‚   â”‚   â”œâ”€â”€ totalSold: Integer
â”‚   â”‚   â””â”€â”€ revenue: BigDecimal
â”‚   â”‚
â”‚   â””â”€â”€ topCategories: List<CategoryPerformanceDTO>
â”‚       â”œâ”€â”€ categoryName: String
â”‚       â”œâ”€â”€ eventsCount: Integer
â”‚       â””â”€â”€ totalRevenue: BigDecimal
â”‚
â””â”€â”€ trends: TrendsDTO
    â”œâ”€â”€ dailyTrends: List<DailyTrendDTO>
    â”‚   â”œâ”€â”€ date: LocalDate
    â”‚   â”œâ”€â”€ orders: Integer
    â”‚   â”œâ”€â”€ revenue: BigDecimal
    â”‚   â””â”€â”€ ticketsSold: Integer
    â”‚
    â””â”€â”€ monthlyTrends: List<MonthlyTrendDTO>
        â”œâ”€â”€ yearMonth: String
        â”œâ”€â”€ orders: Integer
        â”œâ”€â”€ revenue: BigDecimal
        â””â”€â”€ ticketsSold: Integer
```

---

## ğŸ¨ FRONTEND - COMPONENTES VISUALES

### **Dashboard Layout**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ANALYTICS DASHBOARD                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  Organizer: [Nombre Organizador]          Last Updated: [Fecha/Hora]  â”‚
â”‚                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          KPI CARDS (4 columnas)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° Revenue     â”‚  ğŸŸï¸ Tickets     â”‚  ğŸ“… Events      â”‚  ğŸ” Consumptionsâ”‚
â”‚  $15,000.00     â”‚  150 sold       â”‚  5 total        â”‚  300 sold       â”‚
â”‚  â†‘ 14.29%       â”‚  45 orders      â”‚  2 active       â”‚  60% redeemed   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      REVENUE CHART (Line Chart)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  Revenue â”‚                                                             â”‚
â”‚   $20k   â”‚                                    â—â”€â”€â”€â—                    â”‚
â”‚   $15k   â”‚                          â—â”€â”€â”€â—   /                          â”‚
â”‚   $10k   â”‚                 â—â”€â”€â”€â—   /                                   â”‚
â”‚    $5k   â”‚        â—â”€â”€â”€â—   /                                            â”‚
â”‚     $0   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚            Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct  â”‚
â”‚                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 TOP EVENTS & CONSUMPTIONS (2 columnas)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ† Top Events                     â”‚  ğŸ¥‡ Top Consumptions              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ 1. Evento A - 80 tickets     â”‚ â”‚  â”‚ 1. Bebida Premium - 150 sold â”‚â”‚
â”‚  â”‚ 2. Evento B - 50 tickets     â”‚ â”‚  â”‚ 2. Hamburguesa - 100 sold    â”‚â”‚
â”‚  â”‚ 3. Evento C - 20 tickets     â”‚ â”‚  â”‚ 3. Pizza - 50 sold           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              DAILY TRENDS (Last 7 Days - Bar Chart)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  Orders â”‚                                                              â”‚
â”‚    20   â”‚                                    â–ˆ                         â”‚
â”‚    15   â”‚                          â–ˆ         â–ˆ         â–ˆ               â”‚
â”‚    10   â”‚                 â–ˆ        â–ˆ         â–ˆ         â–ˆ        â–ˆ      â”‚
â”‚     5   â”‚        â–ˆ        â–ˆ        â–ˆ         â–ˆ         â–ˆ        â–ˆ      â”‚
â”‚     0   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚           Mon     Tue     Wed     Thu      Fri      Sat      Sun      â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ TECNOLOGÃAS Y VERSIONES

### **Backend**

| TecnologÃ­a | VersiÃ³n | PropÃ³sito |
|------------|---------|-----------|
| Java | 17 | Lenguaje de programaciÃ³n |
| Spring Boot | 3.5.6 | Framework backend |
| Spring Data JPA | Incluido en Boot | Acceso a datos |
| Spring Security | 6.x | AutenticaciÃ³n y autorizaciÃ³n |
| Spring Web | Incluido en Boot | REST API |
| Spring WebFlux | Incluido | RestTemplate para llamadas HTTP |
| JWT (jjwt) | 0.12.6 | Token validation |
| PostgreSQL | 15 | Base de datos |
| Lombok | 1.18.x | ReducciÃ³n de boilerplate |
| Maven | 3.9+ | Build tool |
| Docker | 24.x | ContainerizaciÃ³n |

### **Frontend**

| TecnologÃ­a | VersiÃ³n | PropÃ³sito |
|------------|---------|-----------|
| Angular | 19.2.0 | Framework frontend |
| TypeScript | 5.7.2 | Lenguaje tipado |
| Bootstrap | 5.3.8 | UI framework |
| Chart.js | 4.x | GrÃ¡ficos y visualizaciones |
| ng2-charts | 6.x | Wrapper Angular para Chart.js |
| RxJS | 7.x | Reactive programming |

---

## âš¡ PERFORMANCE

### **Optimizaciones Implementadas**

1. **RestTemplate Reusable**: Single bean compartido en AnalyticsService
2. **Parallel Streams**: CÃ¡lculos de mÃ©tricas en paralelo cuando es posible
3. **Lazy Loading**: Solo calcular mÃ©tricas solicitadas
4. **DTO Projection**: Transferir solo datos necesarios

### **Optimizaciones Futuras (Roadmap)**

1. **Redis Cache**: Cachear dashboards (TTL: 5 minutos)
2. **Database Indexing**: Ãndices en columnas frecuentes
3. **Pagination**: PaginaciÃ³n en trends (no cargar 30 dÃ­as de una vez)
4. **Async Processing**: CompletableFuture para llamadas externas
5. **GraphQL**: Permitir al frontend solicitar solo mÃ©tricas necesarias

### **Benchmarks Esperados**

| OperaciÃ³n | Tiempo Esperado | Notas |
|-----------|----------------|-------|
| Health Check | < 50ms | Sin dependencias externas |
| Dashboard (sin cache) | < 3000ms | 4 llamadas HTTP + cÃ¡lculos |
| Dashboard (con cache) | < 100ms | Leer de Redis |
| Trends Calculation | < 500ms | Stream processing en memoria |

---

## ğŸ› ï¸ CONFIGURACIÃ“N DEV vs PROD

### **Development**

```properties
# application-dev.properties
server.port=8087
spring.datasource.url=jdbc:postgresql://localhost:5439/analytics_db
logging.level.com.packedgo=DEBUG
spring.jpa.show-sql=true
```

### **Production**

```properties
# application-prod.properties
server.port=8087
spring.datasource.url=${DATABASE_URL}
logging.level.com.packedgo=INFO
spring.jpa.show-sql=false
spring.datasource.hikari.maximum-pool-size=20
```

---

## ğŸ“‹ CONCLUSIÃ“N

Esta arquitectura proporciona:

âœ… **Escalabilidad**: Microservicios independientes  
âœ… **Seguridad**: JWT + roles + multi-tenant  
âœ… **Mantenibilidad**: DTOs claros, separaciÃ³n de concerns  
âœ… **Performance**: Optimizaciones en cÃ¡lculos y cachÃ© futuro  
âœ… **Extensibilidad**: FÃ¡cil agregar nuevas mÃ©tricas  

**El Analytics Service estÃ¡ listo para producciÃ³n! ğŸš€**

---

**Autores:** David ElÃ­as Delfino & AgustÃ­n Luparia Mothe  
**InstituciÃ³n:** UTN FRC - Tecnicatura Universitaria en ProgramaciÃ³n  
**Fecha:** Noviembre 2025
