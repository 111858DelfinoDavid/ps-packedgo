<div class="register-container">
  <div class="register-card">
    <!-- Back to Landing Button -->
    <button type="button" class="btn-back-landing" (click)="goToLanding()">
      <i class="bi bi-arrow-left"></i> Volver al inicio
    </button>

    <div class="register-header">
      <i class="bi bi-person-plus-fill"></i>
      <h2>Registro de Cliente</h2>
      <p>√önete a PackedGo</p>
    </div>

    <!-- Success Alert -->
    <div
      *ngIf="successMessage"
      class="alert alert-success alert-dismissible fade show"
      role="alert"
    >
      <i class="bi bi-check-circle-fill me-2"></i>
      {{ successMessage }}
      <button
        type="button"
        class="btn-close"
        (click)="successMessage = ''"
      ></button>
    </div>

    <!-- Error Alert -->
    <div
      *ngIf="errorMessage"
      class="alert alert-danger alert-dismissible fade show"
      role="alert"
    >
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      {{ errorMessage }}
      <button
        type="button"
        class="btn-close"
        (click)="errorMessage = ''"
      ></button>
    </div>

    <form
      [formGroup]="registerForm"
      (ngSubmit)="onSubmit()"
      class="register-form"
    >
      <!-- Username -->
      <div class="form-group">
        <label for="username">
          <i class="bi bi-person"></i>
          Nombre de Usuario
        </label>
        <input
          type="text"
          id="username"
          formControlName="username"
          class="form-control"
          [class.is-invalid]="username?.invalid && username?.touched"
          [class.is-valid]="username?.valid && username?.touched"
          placeholder="Ingresa tu nombre de usuario"
        />
        <div class="invalid-feedback" *ngIf="username?.touched">
          <span *ngIf="username?.errors?.['required']"
            >El nombre de usuario es requerido</span
          >
          <span *ngIf="username?.errors?.['minlength']"
            >M√≠nimo 3 caracteres</span
          >
          <span *ngIf="username?.errors?.['maxlength']"
            >M√°ximo 50 caracteres</span
          >
        </div>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email">
          <i class="bi bi-envelope"></i>
          Correo Electr√≥nico
        </label>
        <input
          type="email"
          id="email"
          formControlName="email"
          class="form-control"
          [class.is-invalid]="email?.invalid && email?.touched"
          [class.is-valid]="email?.valid && email?.touched"
          placeholder="ejemplo@correo.com"
        />
        <div class="invalid-feedback" *ngIf="email?.touched">
          <span *ngIf="email?.errors?.['required']"
            >El correo es requerido</span
          >
          <span *ngIf="email?.errors?.['email']">Ingresa un correo v√°lido</span>
        </div>
      </div>

      <!-- Document -->
      <div class="form-group">
        <label for="document">
          <i class="bi bi-card-text"></i>
          Documento de Identidad
        </label>
        <input
          type="text"
          id="document"
          formControlName="document"
          class="form-control"
          [class.is-invalid]="document?.invalid && document?.touched"
          [class.is-valid]="document?.valid && document?.touched"
          placeholder="Ingresa tu documento"
        />
        <div class="invalid-feedback" *ngIf="document?.touched">
          <span *ngIf="document?.errors?.['required']"
            >El documento es requerido</span
          >
          <span *ngIf="document?.errors?.['pattern']"
            >Solo n√∫meros sin puntos ni guiones</span
          >
        </div>
      </div>

      <!-- Password -->
      <div class="form-group">
        <label for="password">
          <i class="bi bi-lock"></i>
          Contrase√±a
        </label>
        <div class="password-wrapper">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            class="form-control"
            [class.is-invalid]="password?.invalid && password?.touched"
            [class.is-valid]="password?.valid && password?.touched"
            placeholder="Ingresa tu contrase√±a"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="
              showPassword ? 'Ocultar contrase√±a' : 'Mostrar contrase√±a'
            "
          >
            <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
          </button>
        </div>
        <div
          class="invalid-feedback d-block"
          *ngIf="password?.touched && password?.invalid"
        >
          <span *ngIf="password?.errors?.['required']"
            >La contrase√±a es requerida</span
          >
          <span *ngIf="password?.errors?.['minlength']"
            >M√≠nimo 6 caracteres</span
          >
        </div>
      </div>

      <!-- Name -->
      <div class="form-group">
        <label for="name">
          <i class="bi bi-person-badge"></i>
          Nombre
        </label>
        <input
          type="text"
          id="name"
          formControlName="name"
          class="form-control"
          [class.is-invalid]="name?.invalid && name?.touched"
          [class.is-valid]="name?.valid && name?.touched"
          placeholder="Ingresa tu nombre"
        />
        <div class="invalid-feedback" *ngIf="name?.touched">
          <span *ngIf="name?.errors?.['required']">El nombre es requerido</span>
          <span *ngIf="name?.errors?.['minlength']">M√≠nimo 1 caracter</span>
          <span *ngIf="name?.errors?.['maxlength']">M√°ximo 100 caracteres</span>
        </div>
      </div>

      <!-- Last Name -->
      <div class="form-group">
        <label for="lastName">
          <i class="bi bi-person-badge-fill"></i>
          Apellido
        </label>
        <input
          type="text"
          id="lastName"
          formControlName="lastName"
          class="form-control"
          [class.is-invalid]="lastName?.invalid && lastName?.touched"
          [class.is-valid]="lastName?.valid && lastName?.touched"
          placeholder="Ingresa tu apellido"
        />
        <div class="invalid-feedback" *ngIf="lastName?.touched">
          <span *ngIf="lastName?.errors?.['required']"
            >El apellido es requerido</span
          >
          <span *ngIf="lastName?.errors?.['minlength']">M√≠nimo 1 caracter</span>
          <span *ngIf="lastName?.errors?.['maxlength']"
            >M√°ximo 100 caracteres</span
          >
        </div>
      </div>

      <!-- Born Date -->
      <div class="form-group">
        <label for="bornDate">
          <i class="bi bi-calendar-event"></i>
          Fecha de Nacimiento
        </label>
        <input
          type="date"
          id="bornDate"
          formControlName="bornDate"
          class="form-control"
          [class.is-invalid]="bornDate?.invalid && bornDate?.touched"
          [class.is-valid]="bornDate?.valid && bornDate?.touched"
        />
        <div class="invalid-feedback" *ngIf="bornDate?.touched">
          <span *ngIf="bornDate?.errors?.['required']"
            >La fecha de nacimiento es requerida</span
          >
        </div>
      </div>

      <!-- Telephone -->
      <div class="form-group">
        <label for="telephone">
          <i class="bi bi-telephone"></i>
          Tel√©fono
        </label>
        <input
          type="text"
          id="telephone"
          formControlName="telephone"
          class="form-control"
          [class.is-invalid]="telephone?.invalid && telephone?.touched"
          [class.is-valid]="telephone?.valid && telephone?.touched"
          placeholder="Ingresa tu tel√©fono"
        />
        <div class="invalid-feedback" *ngIf="telephone?.touched">
          <span *ngIf="telephone?.errors?.['required']"
            >El tel√©fono es requerido</span
          >
          <span *ngIf="telephone?.errors?.['pattern']"
            >Solo n√∫meros sin espacios</span
          >
        </div>
      </div>

      <!-- Gender -->
      <div class="form-group">
        <label for="gender">
          <i class="bi bi-gender-ambiguous"></i>
          G√©nero
        </label>
        <select
          id="gender"
          formControlName="gender"
          class="form-select"
          [class.is-invalid]="gender?.invalid && gender?.touched"
          [class.is-valid]="gender?.valid && gender?.touched"
        >
          <option value="" disabled>Selecciona tu g√©nero</option>
          <option value="MALE">Masculino</option>
          <option value="FEMALE">Femenino</option>
          <option value="OTHER">Otro</option>
        </select>
        <div class="invalid-feedback" *ngIf="gender?.touched">
          <span *ngIf="gender?.errors?.['required']"
            >El g√©nero es requerido</span
          >
        </div>
      </div>

      <!-- T√©rminos y Condiciones -->
      <div class="form-group terms-section">
        <div class="terms-status" [class.accepted]="acceptTerms?.value">
          <i
            class="bi"
            [class.bi-check-circle-fill]="acceptTerms?.value"
            [class.bi-circle]="!acceptTerms?.value"
          ></i>
          <span *ngIf="!acceptTerms?.value"
            >Debe leer y aceptar los T√©rminos y Condiciones</span
          >
          <span *ngIf="acceptTerms?.value" class="text-success"
            >‚úì T√©rminos y Condiciones aceptados</span
          >
        </div>
        <button
          type="button"
          class="btn-read-terms"
          (click)="openTermsModal()"
          [class.btn-accepted]="acceptTerms?.value"
          [disabled]="acceptTerms?.value"
        >
          <i class="bi bi-file-text"></i>
          {{
            acceptTerms?.value
              ? "T√©rminos Aceptados"
              : "Leer T√©rminos y Condiciones"
          }}
        </button>
        <div
          class="invalid-feedback d-block"
          *ngIf="acceptTerms?.touched && acceptTerms?.invalid"
        >
          <i class="bi bi-exclamation-circle"></i> Debes leer y aceptar los
          t√©rminos para continuar
        </div>
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="btn btn-primary btn-register"
        [disabled]="isLoading"
      >
        <span *ngIf="!isLoading">
          <i class="bi bi-person-check"></i> Registrarse
        </span>
        <span *ngIf="isLoading">
          <span
            class="spinner-border spinner-border-sm me-2"
            role="status"
            aria-hidden="true"
          ></span>
          Registrando...
        </span>
      </button>

      <!-- Login Link -->
      <div class="register-footer">
        <p>
          ¬øYa tienes una cuenta?
          <a routerLink="/customer/login">Inicia Sesi√≥n</a>
        </p>
      </div>
    </form>
  </div>
</div>

<!-- Modal de T√©rminos y Condiciones -->
<div
  class="terms-modal-overlay"
  *ngIf="showTermsModal"
  (click)="closeTermsModal()"
>
  <div class="terms-modal-content" (click)="$event.stopPropagation()">
    <div class="terms-modal-header">
      <h2>T√©rminos y Condiciones de Uso</h2>
      <button class="btn-close-modal" (click)="closeTermsModal()">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>

    <div
      class="terms-modal-body"
      #termsContent
      (scroll)="onTermsScroll($event)"
    >
      <div class="terms-text">
        <p class="last-update">√öltima actualizaci√≥n: Noviembre 2025</p>

        <section class="term-section">
          <h3>1. Aceptaci√≥n de los T√©rminos</h3>
          <p>
            Al acceder, registrarse y utilizar la plataforma PACKEDGO (en
            adelante, la ‚ÄúPlataforma‚Äù), el usuario acepta quedar sujeto a los
            presentes T√©rminos y Condiciones de Uso (los ‚ÄúT√©rminos‚Äù).
          </p>
          <p>
            Si el Usuario no estuviera de acuerdo con alguna de sus
            disposiciones, deber√° abstenerse de utilizar los servicios. El uso
            de la Plataforma implica el conocimiento pleno y la aceptaci√≥n
            expresa de estos T√©rminos.
          </p>
        </section>

        <section class="term-section">
          <h3>2. Descripci√≥n del Servicio</h3>
          <p>
            PACKEDGO S.A.S., C.U.I.T. XX-XXXXXXXX-X, presta servicios digitales
            de intermediaci√≥n tecnol√≥gica para la gesti√≥n, administraci√≥n y
            venta de entradas electr√≥nicas para eventos de diversa √≠ndole.
          </p>
          <p>La Plataforma permite, entre otras funcionalidades:</p>
          <ul>
            <li>La compra de entradas digitales por parte de los Usuarios.</li>
            <li>La gesti√≥n de eventos por parte de los Organizadores.</li>
            <li>
              La generaci√≥n de c√≥digos QR para control y validaci√≥n de accesos.
            </li>
            <li>La implementaci√≥n de consumiciones u otros beneficios.</li>
          </ul>
          <p>
            PACKEDGO act√∫a exclusivamente como intermediario tecnol√≥gico entre
            el Organizador y el Usuario, no siendo organizador, productor ni
            responsable del evento, ni participando en la fijaci√≥n de precios,
            condiciones de acceso o pol√≠ticas de devoluci√≥n.
          </p>
        </section>

        <section class="term-section">
          <h3>3. Registro de Usuario</h3>
          <p>
            Para utilizar determinadas funcionalidades, el Usuario deber√° crear
            una cuenta proporcionando informaci√≥n veraz, completa y actualizada.
          </p>
          <ul>
            <li>Mantener la confidencialidad de sus credenciales de acceso.</li>
            <li>
              Ser responsable de toda actividad realizada desde su cuenta.
            </li>
            <li>Notificar inmediatamente cualquier uso no autorizado.</li>
            <li>No crear cuentas falsas ni utilizar datos de terceros.</li>
          </ul>
          <p>
            PACKEDGO podr√° suspender o cancelar cuentas que incumplan estas
            obligaciones.
          </p>
        </section>

        <section class="term-section">
          <h3>4. Compra de Entradas</h3>

          <h4>4.1 Proceso de Compra</h4>
          <p>
            Las entradas est√°n sujetas a disponibilidad. Una vez completada la
            compra, el Usuario recibir√° un correo de confirmaci√≥n y un c√≥digo QR
            √∫nico por cada entrada adquirida, v√°lido exclusivamente para el
            evento indicado.
          </p>

          <h4>4.2 Precios y Pagos</h4>
          <p>
            Los precios se expresan en pesos argentinos (ARS) e incluyen
            impuestos. Los pagos se procesan mediante proveedores externos como
            STRIPE.
          </p>
          <p>
            PACKEDGO percibe √∫nicamente la comisi√≥n correspondiente por el uso
            de la Plataforma.
          </p>

          <h4>4.3 Cancelaciones y Reembolsos</h4>
          <p>
            Las pol√≠ticas de cancelaci√≥n, modificaci√≥n y reembolso son definidas
            exclusivamente por el Organizador del evento.
          </p>
          <p>
            PACKEDGO podr√° colaborar en la gesti√≥n del reembolso cuando as√≠ lo
            instruya el Organizador y conforme a las condiciones del medio de
            pago utilizado.
          </p>
        </section>

        <section class="term-section">
          <h3>5. Responsabilidades del Organizador</h3>
          <ul>
            <li>Brindar informaci√≥n veraz y actualizada.</li>
            <li>Cumplir con la normativa legal vigente.</li>
            <li>Informar cancelaciones o modificaciones.</li>
            <li>Garantizar la seguridad y condiciones del evento.</li>
          </ul>
          <p>
            PACKEDGO no asume responsabilidad por el incumplimiento de estas
            obligaciones.
          </p>
        </section>

        <section class="term-section">
          <h3>6. Uso de Entradas Digitales</h3>
          <ul>
            <li>
              Las entradas son personales e intransferibles salvo autorizaci√≥n.
            </li>
            <li>No pueden ser falsificadas ni revendidas.</li>
            <li>Ser√°n validadas electr√≥nicamente al ingreso.</li>
          </ul>
          <p>
            PACKEDGO no se responsabiliza por entradas extraviadas o adquiridas
            fuera de los canales oficiales.
          </p>
        </section>

        <section class="term-section">
          <h3>7. Propiedad Intelectual</h3>
          <p>
            Todos los contenidos de la Plataforma son propiedad exclusiva de
            PACKEDGO S.A.S. o de sus licenciantes y se encuentran protegidos por
            la legislaci√≥n vigente.
          </p>
        </section>

        <section class="term-section">
          <h3>8. Privacidad y Datos Personales</h3>
          <p>
            PACKEDGO es responsable del tratamiento de los datos personales
            conforme a la Ley N¬∞ 25.326 de Protecci√≥n de Datos Personales.
          </p>
          <ul>
            <li>Procesar operaciones y emitir entradas.</li>
            <li>Validar transacciones y prevenir fraudes.</li>
            <li>Brindar soporte y mejorar los servicios.</li>
          </ul>
          <p>
            El Usuario podr√° ejercer sus derechos de acceso, rectificaci√≥n,
            cancelaci√≥n u oposici√≥n escribiendo a legal&#64;packedgo.com.
          </p>
          <p>
            La Agencia de Acceso a la Informaci√≥n P√∫blica es el √≥rgano de
            control de la Ley N¬∞ 25.326.
          </p>
        </section>

        <section class="term-section">
          <h3>9. Limitaci√≥n de Responsabilidad</h3>
          <ul>
            <li>Cancelaciones o modificaciones de eventos.</li>
            <li>Da√±os ocurridos durante el evento.</li>
            <li>Fallos t√©cnicos o interrupciones del servicio.</li>
            <li>Da√±os indirectos derivados del uso de la Plataforma.</li>
          </ul>
          <p>
            Nada de lo dispuesto limitar√° la responsabilidad de PACKEDGO cuando
            ello est√© prohibido por la legislaci√≥n vigente.
          </p>
        </section>

        <section class="term-section">
          <h3>10. Conducta Prohibida</h3>
          <ul>
            <li>Revender entradas sin autorizaci√≥n.</li>
            <li>Manipular o falsificar c√≥digos QR.</li>
            <li>Utilizar la Plataforma con fines ilegales.</li>
            <li>Interferir con el funcionamiento del sistema.</li>
          </ul>
        </section>

        <section class="term-section">
          <h3>11. Modificaciones</h3>
          <p>
            PACKEDGO podr√° modificar estos T√©rminos, los cuales entrar√°n en
            vigencia desde su publicaci√≥n en la Plataforma.
          </p>
        </section>

        <section class="term-section">
          <h3>12. Jurisdicci√≥n</h3>
          <p>
            Estos T√©rminos se rigen por las leyes de la Rep√∫blica Argentina.
            Cualquier controversia ser√° sometida a los Tribunales Ordinarios de
            la Ciudad de C√≥rdoba, sin perjuicio de los derechos del consumidor.
          </p>
        </section>

        <section class="term-section">
          <h3>13. Contacto</h3>
          <ul>
            <li>üìß events.packedgo&#64;gmail.com</li>
            <li>üìû +54 351 1234-567</li>
            <li>
              üè¢ Maestro M. Lopez esq, Cruz Roja Argentina S/N C√≥rdoba,
              Argentina
            </li>
          </ul>
        </section>

        <section class="term-section">
          <h3>14. Aceptaci√≥n</h3>
          <p>
            Al hacer clic en ‚ÄúAcepto los T√©rminos y Condiciones‚Äù, el Usuario
            declara haber le√≠do, comprendido y aceptado √≠ntegramente el presente
            documento.
          </p>
        </section>
      </div>
    </div>

    <div class="terms-modal-footer">
      <div class="scroll-indicator" *ngIf="!hasScrolledToBottom">
        <i class="bi bi-arrow-down"></i>
        <span>Despl√°zate hacia abajo para continuar</span>
      </div>
      <button
        class="btn-accept-terms"
        [disabled]="!hasScrolledToBottom"
        (click)="acceptTermsAndClose()"
      >
        <i class="bi bi-check-circle"></i>
        Acepto los T√©rminos y Condiciones
      </button>
    </div>
  </div>
</div>
