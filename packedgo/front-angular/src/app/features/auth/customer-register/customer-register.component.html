<div class="register-container">
  <div class="register-card">
    <!-- Back to Landing Button -->
    <button type="button" class="btn-back-landing" (click)="goToLanding()">
      <i class="bi bi-arrow-left"></i> Volver al inicio
    </button>

    <div class="register-header">
      <i class="bi bi-person-plus-fill"></i>
      <h2>Registro de Cliente</h2>
      <p>√önete a PackedGo</p>
    </div>

    <!-- Success Alert -->
    <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
      <i class="bi bi-check-circle-fill me-2"></i>
      {{ successMessage }}
      <button type="button" class="btn-close" (click)="successMessage = ''"></button>
    </div>

    <!-- Error Alert -->
    <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      {{ errorMessage }}
      <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
      
      <!-- Username -->
      <div class="form-group">
        <label for="username">
          <i class="bi bi-person"></i>
          Nombre de Usuario
        </label>
        <input 
          type="text" 
          id="username"
          formControlName="username"
          class="form-control"
          [class.is-invalid]="username?.invalid && username?.touched"
          [class.is-valid]="username?.valid && username?.touched"
          placeholder="Ingresa tu nombre de usuario"
        />
        <div class="invalid-feedback" *ngIf="username?.touched">
          <span *ngIf="username?.errors?.['required']">El nombre de usuario es requerido</span>
          <span *ngIf="username?.errors?.['minlength']">M√≠nimo 3 caracteres</span>
          <span *ngIf="username?.errors?.['maxlength']">M√°ximo 50 caracteres</span>
        </div>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email">
          <i class="bi bi-envelope"></i>
          Correo Electr√≥nico
        </label>
        <input 
          type="email" 
          id="email"
          formControlName="email"
          class="form-control"
          [class.is-invalid]="email?.invalid && email?.touched"
          [class.is-valid]="email?.valid && email?.touched"
          placeholder="ejemplo@correo.com"
        />
        <div class="invalid-feedback" *ngIf="email?.touched">
          <span *ngIf="email?.errors?.['required']">El correo es requerido</span>
          <span *ngIf="email?.errors?.['email']">Ingresa un correo v√°lido</span>
        </div>
      </div>

      <!-- Document -->
      <div class="form-group">
        <label for="document">
          <i class="bi bi-card-text"></i>
          Documento de Identidad
        </label>
        <input 
          type="text" 
          id="document"
          formControlName="document"
          class="form-control"
          [class.is-invalid]="document?.invalid && document?.touched"
          [class.is-valid]="document?.valid && document?.touched"
          placeholder="Ingresa tu documento"
        />
        <div class="invalid-feedback" *ngIf="document?.touched">
          <span *ngIf="document?.errors?.['required']">El documento es requerido</span>
          <span *ngIf="document?.errors?.['pattern']">Solo n√∫meros sin puntos ni guiones</span>
        </div>
      </div>

      <!-- Password -->
      <div class="form-group">
        <label for="password">
          <i class="bi bi-lock"></i>
          Contrase√±a
        </label>
        <div class="password-wrapper">
          <input 
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            class="form-control"
            [class.is-invalid]="password?.invalid && password?.touched"
            [class.is-valid]="password?.valid && password?.touched"
            placeholder="Ingresa tu contrase√±a"
          />
          <button 
            type="button" 
            class="password-toggle" 
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword ? 'Ocultar contrase√±a' : 'Mostrar contrase√±a'"
          >
            <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
          </button>
        </div>
        <div class="invalid-feedback d-block" *ngIf="password?.touched && password?.invalid">
          <span *ngIf="password?.errors?.['required']">La contrase√±a es requerida</span>
          <span *ngIf="password?.errors?.['minlength']">M√≠nimo 6 caracteres</span>
        </div>
      </div>

      <!-- Name -->
      <div class="form-group">
        <label for="name">
          <i class="bi bi-person-badge"></i>
          Nombre
        </label>
        <input 
          type="text" 
          id="name"
          formControlName="name"
          class="form-control"
          [class.is-invalid]="name?.invalid && name?.touched"
          [class.is-valid]="name?.valid && name?.touched"
          placeholder="Ingresa tu nombre"
        />
        <div class="invalid-feedback" *ngIf="name?.touched">
          <span *ngIf="name?.errors?.['required']">El nombre es requerido</span>
          <span *ngIf="name?.errors?.['minlength']">M√≠nimo 1 caracter</span>
          <span *ngIf="name?.errors?.['maxlength']">M√°ximo 100 caracteres</span>
        </div>
      </div>

      <!-- Last Name -->
      <div class="form-group">
        <label for="lastName">
          <i class="bi bi-person-badge-fill"></i>
          Apellido
        </label>
        <input 
          type="text" 
          id="lastName"
          formControlName="lastName"
          class="form-control"
          [class.is-invalid]="lastName?.invalid && lastName?.touched"
          [class.is-valid]="lastName?.valid && lastName?.touched"
          placeholder="Ingresa tu apellido"
        />
        <div class="invalid-feedback" *ngIf="lastName?.touched">
          <span *ngIf="lastName?.errors?.['required']">El apellido es requerido</span>
          <span *ngIf="lastName?.errors?.['minlength']">M√≠nimo 1 caracter</span>
          <span *ngIf="lastName?.errors?.['maxlength']">M√°ximo 100 caracteres</span>
        </div>
      </div>

      <!-- Born Date -->
      <div class="form-group">
        <label for="bornDate">
          <i class="bi bi-calendar-event"></i>
          Fecha de Nacimiento
        </label>
        <input 
          type="date" 
          id="bornDate"
          formControlName="bornDate"
          class="form-control"
          [class.is-invalid]="bornDate?.invalid && bornDate?.touched"
          [class.is-valid]="bornDate?.valid && bornDate?.touched"
        />
        <div class="invalid-feedback" *ngIf="bornDate?.touched">
          <span *ngIf="bornDate?.errors?.['required']">La fecha de nacimiento es requerida</span>
        </div>
      </div>

      <!-- Telephone -->
      <div class="form-group">
        <label for="telephone">
          <i class="bi bi-telephone"></i>
          Tel√©fono
        </label>
        <input 
          type="text" 
          id="telephone"
          formControlName="telephone"
          class="form-control"
          [class.is-invalid]="telephone?.invalid && telephone?.touched"
          [class.is-valid]="telephone?.valid && telephone?.touched"
          placeholder="Ingresa tu tel√©fono"
        />
        <div class="invalid-feedback" *ngIf="telephone?.touched">
          <span *ngIf="telephone?.errors?.['required']">El tel√©fono es requerido</span>
          <span *ngIf="telephone?.errors?.['pattern']">Solo n√∫meros sin espacios</span>
        </div>
      </div>

      <!-- Gender -->
      <div class="form-group">
        <label for="gender">
          <i class="bi bi-gender-ambiguous"></i>
          G√©nero
        </label>
        <select 
          id="gender"
          formControlName="gender"
          class="form-select"
          [class.is-invalid]="gender?.invalid && gender?.touched"
          [class.is-valid]="gender?.valid && gender?.touched"
        >
          <option value="" disabled>Selecciona tu g√©nero</option>
          <option value="MALE">Masculino</option>
          <option value="FEMALE">Femenino</option>
          <option value="OTHER">Otro</option>
          <option value="PREFER_NOT_TO_SAY">Prefiero no decir</option>
        </select>
        <div class="invalid-feedback" *ngIf="gender?.touched">
          <span *ngIf="gender?.errors?.['required']">El g√©nero es requerido</span>
        </div>
      </div>

      <!-- T√©rminos y Condiciones -->
      <div class="form-group terms-section">
        <div class="terms-status" [class.accepted]="acceptTerms?.value">
          <i class="bi" [class.bi-check-circle-fill]="acceptTerms?.value" [class.bi-circle]="!acceptTerms?.value"></i>
          <span *ngIf="!acceptTerms?.value">Debe leer y aceptar los T√©rminos y Condiciones</span>
          <span *ngIf="acceptTerms?.value" class="text-success">‚úì T√©rminos y Condiciones aceptados</span>
        </div>
        <button 
          type="button" 
          class="btn-read-terms"
          (click)="openTermsModal()"
          [class.btn-accepted]="acceptTerms?.value"
          [disabled]="acceptTerms?.value"
        >
          <i class="bi bi-file-text"></i>
          {{ acceptTerms?.value ? 'T√©rminos Aceptados' : 'Leer T√©rminos y Condiciones' }}
        </button>
        <div class="invalid-feedback d-block" *ngIf="acceptTerms?.touched && acceptTerms?.invalid">
          <i class="bi bi-exclamation-circle"></i> Debes leer y aceptar los t√©rminos para continuar
        </div>
      </div>

      <!-- Submit Button -->
      <button 
        type="submit" 
        class="btn btn-primary btn-register"
        [disabled]="isLoading"
      >
        <span *ngIf="!isLoading">
          <i class="bi bi-person-check"></i> Registrarse
        </span>
        <span *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          Registrando...
        </span>
      </button>

      <!-- Login Link -->
      <div class="register-footer">
        <p>¬øYa tienes una cuenta? <a routerLink="/customer/login">Inicia Sesi√≥n</a></p>
      </div>
    </form>
  </div>
</div>

<!-- Modal de T√©rminos y Condiciones -->
<div class="terms-modal-overlay" *ngIf="showTermsModal" (click)="closeTermsModal()">
  <div class="terms-modal-content" (click)="$event.stopPropagation()">
    <div class="terms-modal-header">
      <h2>T√©rminos y Condiciones de Uso</h2>
      <button class="btn-close-modal" (click)="closeTermsModal()">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
    
    <div class="terms-modal-body" #termsContent (scroll)="onTermsScroll($event)">
      <div class="terms-text">
        <p class="last-update">√öltima actualizaci√≥n: Noviembre 2025</p>

        <section class="term-section">
          <h3>1. Aceptaci√≥n de los T√©rminos</h3>
          <p>
            Al acceder y utilizar la plataforma PACKEDGO, usted acepta quedar sujeto a los presentes T√©rminos y Condiciones de Uso (en adelante, "T√©rminos y Condiciones").
            Si no est√° de acuerdo con alguna de sus disposiciones, deber√° abstenerse de utilizar nuestros servicios.
            La utilizaci√≥n de la plataforma implica el pleno conocimiento y aceptaci√≥n de todas las condiciones aqu√≠ establecidas.
          </p>
        </section>

        <section class="term-section">
          <h3>2. Descripci√≥n del Servicio</h3>
          <p>
            PACKEDGO S.A.S., C.U.I.T. XX-XXXXXXXX-X, es una empresa dedicada a la prestaci√≥n de servicios digitales de intermediaci√≥n para la compra, venta y gesti√≥n de entradas electr√≥nicas para eventos de diversa √≠ndole.
          </p>
          <p>La plataforma permite:</p>
          <ul>
            <li>La compra de entradas digitales.</li>
            <li>La gesti√≥n de eventos por parte de los organizadores.</li>
            <li>La generaci√≥n de c√≥digos QR para control y validaci√≥n de accesos.</li>
            <li>La implementaci√≥n de sistemas de consumiciones dentro de eventos.</li>
          </ul>
          <p>
            PACKEDGO act√∫a √∫nicamente como intermediario tecnol√≥gico entre el organizador del evento (en adelante, el "Organizador") y el usuario final (en adelante, el "Usuario"), y no asume responsabilidad alguna respecto de la organizaci√≥n, calidad, contenido o seguridad del evento.
          </p>
        </section>

        <section class="term-section">
          <h3>3. Registro de Usuario</h3>
          <p>
            Para utilizar determinados servicios, el Usuario deber√° crear una cuenta en la plataforma, proporcionando informaci√≥n veraz, completa y actualizada.
            Al registrarse, el Usuario se compromete a:
          </p>
          <ul>
            <li>Mantener la confidencialidad de sus credenciales de acceso.</li>
            <li>Ser responsable de todas las actividades realizadas con su cuenta.</li>
            <li>Notificar de inmediato a PACKEDGO ante cualquier uso no autorizado.</li>
            <li>No crear cuentas falsas, duplicadas ni utilizar datos ajenos.</li>
          </ul>
          <p>El incumplimiento de estas condiciones podr√° derivar en la suspensi√≥n o eliminaci√≥n de la cuenta del Usuario.</p>
        </section>

        <section class="term-section">
          <h3>4. Compra de Entradas</h3>
          <h4>4.1 Proceso de Compra</h4>
          <p>Las entradas se encuentran sujetas a disponibilidad. Al completar una compra, el Usuario recibir√°:</p>
          <ul>
            <li>Un correo electr√≥nico de confirmaci√≥n.</li>
            <li>Un c√≥digo QR √∫nico e intransferible por cada entrada adquirida.</li>
            <li>La garant√≠a de validez del ticket exclusivamente para el evento especificado.</li>
          </ul>

          <h4>4.2 Precios y Pagos</h4>
          <p>
            Todos los precios se expresan en pesos argentinos (ARS) e incluyen los impuestos aplicables.
            Los pagos se procesan a trav√©s de MERCADOPAGO u otros medios autorizados.
            PACKEDGO act√∫a como intermediario y no percibe la totalidad de los fondos, sino √∫nicamente la comisi√≥n correspondiente por el uso de su sistema.
          </p>

          <h4>4.3 Cancelaciones y Reembolsos</h4>
          <p>
            Las pol√≠ticas de devoluci√≥n o reembolso dependen exclusivamente del Organizador del evento.
            En caso de cancelaci√≥n o modificaci√≥n del evento, PACKEDGO no se responsabiliza de la devoluci√≥n de los montos abonados, salvo que el Organizador haya solicitado la gesti√≥n del reembolso a trav√©s de nuestra plataforma, dentro de los plazos que determine el procesador de pagos.
          </p>
        </section>

        <section class="term-section">
          <h3>5. Responsabilidades del Organizador</h3>
          <p>Los Organizadores que utilicen la plataforma se obligan a:</p>
          <ul>
            <li>Brindar informaci√≥n veraz y actualizada sobre sus eventos.</li>
            <li>Cumplir con todas las disposiciones legales aplicables.</li>
            <li>Informar oportunamente sobre modificaciones, cancelaciones o reprogramaciones.</li>
            <li>Garantizar la seguridad, accesibilidad y condiciones generales del evento.</li>
          </ul>
          <p>PACKEDGO no interviene ni asume responsabilidad alguna por el cumplimiento de estas obligaciones.</p>
        </section>

        <section class="term-section">
          <h3>6. Uso de Entradas Digitales</h3>
          <p>Las entradas digitales emitidas por PACKEDGO y sus c√≥digos QR:</p>
          <ul>
            <li>Son personales e intransferibles, salvo autorizaci√≥n expresa del Organizador.</li>
            <li>No pueden ser duplicadas, falsificadas ni revendidas sin permiso.</li>
            <li>Ser√°n validadas mediante escaneo electr√≥nico al ingreso del evento.</li>
            <li>Podr√°n incluir consumiciones u otros beneficios asociados a la categor√≠a adquirida.</li>
          </ul>
          <p>PACKEDGO no se responsabiliza por entradas extraviadas, adulteradas o adquiridas fuera de los canales oficiales.</p>
        </section>

        <section class="term-section">
          <h3>7. Propiedad Intelectual</h3>
          <p>
            Todos los contenidos de la plataforma PACKEDGO ‚Äîincluyendo el dise√±o, software, bases de datos, logotipos, textos, im√°genes, gr√°ficos y dem√°s elementos‚Äî son propiedad exclusiva de PACKEDGO S.A.S. o de sus licenciantes.
            Su reproducci√≥n, copia, distribuci√≥n o modificaci√≥n sin autorizaci√≥n previa y por escrito est√° estrictamente prohibida.
          </p>
        </section>

        <section class="term-section">
          <h3>8. Privacidad y Datos Personales</h3>
          <p>El tratamiento de los datos personales del Usuario se realiza conforme a la Ley N¬∞ 25.326 de Protecci√≥n de Datos Personales y normas complementarias.</p>
          <p>PACKEDGO podr√° utilizar los datos para:</p>
          <ul>
            <li>Procesar operaciones y emitir entradas.</li>
            <li>Validar transacciones y prevenir fraudes.</li>
            <li>Brindar soporte t√©cnico y atenci√≥n al Usuario.</li>
            <li>Mejorar la calidad de los servicios.</li>
          </ul>
          <p>
            PACKEDGO no almacena informaci√≥n de los medios de pago utilizados.
            Los Usuarios podr√°n solicitar el acceso, rectificaci√≥n o eliminaci√≥n de sus datos comunic√°ndose a legal&#64;packedgo.com.
          </p>
        </section>

        <section class="term-section">
          <h3>9. Limitaci√≥n de Responsabilidad</h3>
          <p>PACKEDGO no ser√° responsable, directa o indirectamente, por:</p>
          <ul>
            <li>La cancelaci√≥n, reprogramaci√≥n o modificaci√≥n de eventos.</li>
            <li>Cualquier da√±o, lesi√≥n o p√©rdida que ocurra durante el evento.</li>
            <li>Fallos t√©cnicos, interrupciones o p√©rdida de informaci√≥n.</li>
            <li>Da√±os indirectos, incidentales o consecuenciales derivados del uso de la plataforma.</li>
          </ul>
          <p>El Usuario reconoce que PACKEDGO act√∫a exclusivamente como intermediario tecnol√≥gico entre las partes.</p>
        </section>

        <section class="term-section">
          <h3>10. Conducta Prohibida</h3>
          <p>Queda expresamente prohibido:</p>
          <ul>
            <li>Revender entradas sin autorizaci√≥n del Organizador.</li>
            <li>Falsificar, duplicar o manipular c√≥digos QR.</li>
            <li>Utilizar la plataforma para fines ilegales o fraudulentos.</li>
            <li>Interferir con el funcionamiento del sistema o de los servidores.</li>
            <li>Crear m√∫ltiples cuentas sin justificaci√≥n v√°lida.</li>
          </ul>
          <p>El incumplimiento de estas disposiciones podr√° resultar en la suspensi√≥n inmediata de la cuenta y posibles acciones legales.</p>
        </section>

        <section class="term-section">
          <h3>11. Modificaciones del Servicio</h3>
          <p>
            PACKEDGO podr√°, en cualquier momento y sin previo aviso, modificar, suspender o discontinuar total o parcialmente el servicio ofrecido, as√≠ como tambi√©n actualizar estos T√©rminos y Condiciones.
            El uso continuado de la plataforma por parte del Usuario implicar√° la aceptaci√≥n t√°cita de las nuevas condiciones.
          </p>
        </section>

        <section class="term-section">
          <h3>12. Jurisdicci√≥n y Ley Aplicable</h3>
          <p>
            Estos T√©rminos y Condiciones se rigen por las leyes de la Rep√∫blica Argentina.
            Cualquier controversia ser√° sometida a los Tribunales Ordinarios de la Ciudad de C√≥rdoba, con renuncia expresa a cualquier otro fuero o jurisdicci√≥n que pudiera corresponder.
          </p>
        </section>

        <section class="term-section">
          <h3>13. Contacto</h3>
          <p>Para consultas relacionadas con estos T√©rminos y Condiciones o el funcionamiento de la plataforma, puede contactarse con nosotros a trav√©s de:</p>
          <ul>
            <li>üìß legal&#64;packedgo.com</li>
            <li>üìû +54 351 456-7890</li>
            <li>üè¢ Av. Col√≥n 1234, Ciudad de C√≥rdoba, Rep√∫blica Argentina</li>
          </ul>
        </section>

        <section class="term-section">
          <h3>14. Aceptaci√≥n y Vigencia</h3>
          <p>
            Al hacer clic en "Acepto los T√©rminos y Condiciones" durante el registro o utilizaci√≥n del servicio, el Usuario declara haber le√≠do, comprendido y aceptado la totalidad del presente documento.
          </p>
          <p>
            Estos T√©rminos y Condiciones entran en vigencia desde el momento de su aceptaci√≥n y permanecer√°n aplicables mientras el Usuario utilice los servicios de PACKEDGO.
          </p>
        </section>
      </div>
    </div>

    <div class="terms-modal-footer">
      <div class="scroll-indicator" *ngIf="!hasScrolledToBottom">
        <i class="bi bi-arrow-down"></i>
        <span>Despl√°zate hacia abajo para continuar</span>
      </div>
      <button 
        class="btn-accept-terms"
        [disabled]="!hasScrolledToBottom"
        (click)="acceptTermsAndClose()"
      >
        <i class="bi bi-check-circle"></i>
        Acepto los T√©rminos y Condiciones
      </button>
    </div>
  </div>
</div>
